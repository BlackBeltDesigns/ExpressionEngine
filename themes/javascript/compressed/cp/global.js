/*!
 * ExpressionEngine - by EllisLab
 *
 * @package		ExpressionEngine
 * @author		ExpressionEngine Dev Team
 * @copyright	Copyright (c) 2003 - 2011, EllisLab, Inc.
 * @license		http://expressionengine.com/user_guide/license.html
 * @link		http://expressionengine.com
 * @since		Version 2.0
 * @filesource
 */

jQuery(document).ready(function(){function l(){var c=EE.SESS_TIMEOUT-6E4,b=EE.XID_TIMEOUT-6E4,d=c<b?c:b,f=false,e,h;h=function(){a.ajax({type:"POST",dataType:"json",url:EE.BASE+"&C=login&M=refresh_xid",success:function(g){a("input[name='XID']").val(g.xid);EE.XID=g.xid;setTimeout(h,b)}})};e=function(){var g='<form><div id="logOutWarning" style="text-align:center"><p>'+EE.lang.session_expiring+'</p><label for="username">'+EE.lang.username+'</label>: <input type="text" id="log_backin_username" name="username" value="" style="width:100px" size="35" dir="ltr" id="username" maxlength="32"  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label for="password">'+
EE.lang.password+'</label>: <input class="field" id="log_backin_password" type="password" name="password" value="" style="width:100px" size="32" dir="ltr" id="password" maxlength="32"  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="submit" id="submit" name="submit" value="'+EE.lang.login+'" class="submit" /><span id="logInSpinner"></span></div></form>',i;if(f===true){(void 0)(f);return false}else setTimeout(void 0,d);a.ee_notice(g,{type:"custom",open:true,close_on_click:false});i=a("#logOutWarning");
i.find("#log_backin_username").focus();i.find("input#submit").click(function(){var j=i.find("input#log_backin_username").val(),o=i.find("input#log_backin_password").val(),m=a(this),n=i.find("span#logInSpinner");m.hide();n.html('<img src="'+EE.PATH_CP_GBL_IMG+'loader_blackbg.gif" />');a.ajax({type:"POST",dataType:"json",url:EE.BASE+"&C=login&M=authenticate&is_ajax=true",data:{username:j,password:o,XID:EE.XID},success:function(k){f=true;if(k.messageType==="success"){a("input[name='XID']").val(k.xid);
i.slideUp("fast");a.ee_notice(k.message,{type:"custom",open:true});EE.XID=k.xid;f=true;clearTimeout(e);setTimeout(e,d)}else if(k.messageType==="failure"){i.before('<div id="loginCheckFailure">'+k.message+"</div>");n.hide("fast");m.css("display","inline")}else if(k.messageType==="logout")window.location.href=EE.BASE+"&C=login&M=logout&auto_expire=true"}});return false})};EE.SESS_TYPE==="c"?setTimeout(h,b):setTimeout(e,d)}function p(){var c=a(".notice").filter("p.js_hide"),b={success:"message_success",
notice:"message",error:"message_failure"},d=[],f=0,e,h;for(e in b)if(EE.flashdata.hasOwnProperty(b[e])){h=e==="error"?c.filter(".failure").slice(0,1):e==="success"?c.filter(".success").slice(0,1):c.slice(0,1);d[f++]={message:EE.flashdata[b[e]],type:e};h.remove()}d.length&&a.ee_notice(d)}var a=jQuery;a(document).bind("ajaxComplete",function(c,b){if(b.status&&+b.status===401)window.location=EE.BASE+"&"+b.responseText});if(false in document.createElement("input")){EE.insert_placeholders=function(){a('input[type="text"]').each(function(){if(this.placeholder){var c=
a(this),b=this.placeholder,d=c.css("color");c.val()==""&&c.data("user_data","n");c.focus(function(){c.css("color",d);if(c.val()===b){c.val("");c.data("user_data","y")}}).blur(function(){if(c.val()===""||c.val===b){c.val(b).css("color","#888");c.data("user_data","n")}}).trigger("blur")}})};EE.insert_placeholders()}a('a[rel="external"]').click(function(){window.open(this.href);return false});finalLogOutTimer=function(c){var b=a('<div id="logOutConfirm">'+EE.lang.session_timeout+" </div>"),d=30,f=d,
e,h,g,i;g=function(){window.location=EE.BASE+"&C=login&M=logout&auto_expire=true"};i=function(){if(d<1)return setTimeout(g,0);else d===f&&a(window).bind("unload.logout",g);b.dialog("option","title",EE.lang.logout+" ("+(d--||"...")+")");e=setTimeout(i,1E3)};h={Cancel:function(){a(this).dialog("close")}};h[EE.lang.logout]=g;b.dialog({autoOpen:false,resizable:false,modal:true,title:EE.lang.logout,position:"center",minHeight:"0",buttons:h,beforeClose:function(){clearTimeout(e);a(window).unbind("unload.logout");
d=f;a.ajax({type:"POST",dataType:"json",url:EE.BASE+"&C=login&M=refresh_xid",success:function(j){a("input[name='XID']").val(j.xid);EE.XID=j.xid;a("#logOutWarning").slideUp("fast");l()}});c=false}});a("#logOutConfirm").dialog("open");a(".ui-dialog-buttonpane button:eq(2)").focus();i();return false};EE.SESS_TIMEOUT&&l();(function(){var c={revealSidebarLink:"77%",hideSidebarLink:"100%"},b=a("#mainContent"),d=a("#sidebarContent"),f=b.height(),e=d.height(),h;if(EE.CP_SIDEBAR_STATE==="n"){b.css("width",
"100%");a("#revealSidebarLink").css("display","block");a("#hideSidebarLink").hide();d.show();e=d.height();d.hide()}else{d.hide();f=b.height();d.show()}h=e>f?e:f;a("#revealSidebarLink, #hideSidebarLink").click(function(){var g=a(this),i=g.siblings("a"),j=this.id==="revealSidebarLink";a.ajax({type:"POST",dataType:"json",url:EE.BASE+"&C=myaccount&M=update_sidebar_status",data:{XID:EE.XID,show:j},success:function(){}});a("#sideBar").css({position:"absolute","float":"",right:"0"});g.hide();i.css("display",
"block");d.slideToggle();b.animate({width:c[this.id],height:j?h:f},function(){b.height("");a("#sideBar").css({position:"","float":"right"})});return false})})();EE.flashdata!==undefined&&p();EE.notepad=function(){var c=a("#notePad"),b=a("#notepad_form"),d=a("#notePadTextEdit"),f=a("#notePadControls"),e=a("#notePadText").removeClass("js_show"),h=e.text(),g=d.val();return{init:function(){g&&e.html(g.replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\n/ig,"<br />"));c.click(EE.notepad.show);f.find("a.cancel").click(EE.notepad.hide);
b.submit(EE.notepad.submit);f.find("input.submit").click(EE.notepad.submit);d.autoResize()},submit:function(){g=a.trim(d.val());var i=g.replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\n/ig,"<br />");d.attr("readonly","readonly").css("opacity",0.5);f.find("#notePadSaveIndicator").show();a.post(b.attr("action"),{notepad:g,XID:EE.XID},function(){e.html(i||h).show();d.attr("readonly","").css("opacity",1).hide();f.hide().find("#notePadSaveIndicator").hide()},"json");return false},show:function(){if(f.is(":visible"))return false;
var i="";if(e.hide().text()!==h)i=e.html().replace(/<br>/ig,"\n").replace(/&lt;/ig,"<").replace(/&gt;/ig,">");f.show();d.val(i).show().height(0).focus().trigger("keypress")},hide:function(){e.show();d.hide();f.hide();return false}}}();EE.notepad.init();a("#accessoryTabs li a").click(function(){var c=a(this).parent("li"),b=a("#"+this.className);if(c.hasClass("current")){b.hide();c.removeClass("current")}else{if(c.siblings().hasClass("current")){b.show().siblings(":not(#accessoryTabs)").hide();c.siblings().removeClass("current")}else b.slideDown();
c.addClass("current")}return false});(function(){var c=a("#search"),b=c.clone(),d=a("#cp_search_form").find(".searchButton"),f;f=function(){var e=a(this).attr("action"),h={cp_search_keywords:a("#cp_search_keywords").attr("value")};a.ajax({url:e+"&ajax=y",data:h,beforeSend:function(){d.toggle()},success:function(g){d.toggle();c=c.replaceWith(b);b.html(g);a("#cp_reset_search").click(function(){b=b.replaceWith(c);a("#cp_search_form").submit(f);a("#cp_search_keywords").select();return false})},dataType:"html"});
return false};a("#cp_search_form").submit(f)})();a("h4","#quickLinks").click(function(){window.location.href=EE.BASE+"&C=myaccount&M=quicklinks"}).add("#notePad").hover(function(){a(".sidebar_hover_desc",this).show()},function(){a(".sidebar_hover_desc",this).hide()}).css("cursor","pointer");a("#activeUser").one("mouseover",function(){var c=a('<div id="logOutConfirm">'+EE.lang.logout_confirm+" </div>"),b=30,d=b,f,e,h,g;h=function(){a.ajax({url:EE.BASE+"&C=login&M=logout",async:!a.browser.safari});
window.location=EE.BASE+"&C=login&M=logout"};g=function(){if(b<1)return setTimeout(h,0);else b===d&&a(window).bind("unload.logout",h);c.dialog("option","title",EE.lang.logout+" ("+(b--||"...")+")");f=setTimeout(g,1E3)};e={Cancel:function(){a(this).dialog("close")}};e[EE.lang.logout]=h;c.dialog({autoOpen:false,resizable:false,modal:true,title:EE.lang.logout,position:"center",minHeight:"0",buttons:e,beforeClose:function(){clearTimeout(f);a(window).unbind("unload.logout");b=d}});a("a.logOutButton",this).click(function(){a("#logOutConfirm").dialog("open");
a(".ui-dialog-buttonpane button:eq(2)").focus();g();return false})});a(".js_show").show()});
