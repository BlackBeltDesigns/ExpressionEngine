(function(f){var d=f("a[href*=edit_toolset]:not(.addTab)"),i=f('<div id="rte_toolset_editor_modal"><div class="contents"/></div>');i.dialog({width:600,height:420,resizable:false,position:["center","center"],modal:true,draggable:true,autoOpen:false,zIndex:99999,open:function(o,n){g()}});function b(n){f.get(n,function(o){i.find(".contents").html(f("#mainContent .contents",o).html()).find("div.heading").remove().end().end().dialog("option","title",f("#mainContent .edit",o).text()).dialog("open")})}if(d.length){d.click(function(o){o.preventDefault();var n=f(this).closest("a");b(n.attr("href"))})}var h=f("#registerUser select#rte_toolset_id").change(m),l=f('<input type="button" class="submit"/>').css("margin-left","5px").val(EE.rte.edit_text);function c(){i.dialog("option",{height:365});var n=EE.rte.toolset_builder_url.replace(/&amp;/g,"&");if(h.find("option:selected").text()==EE.rte.custom_toolset_text){if(h.val()!="new"){n+="&rte_toolset_id="+h.val()}b(n)}}function m(){if(h.find("option:selected").text()==EE.rte.custom_toolset_text){h.parent().append(l);if(h.val()=="new"){c()}}else{l.remove()}}m();h.parent().delegate("input.submit","click",c);var a=f("#null"),k=a,j=a;function g(){a=f("#null");k=f("#rte-tools-selected").bind("sortupdate",e);j=f("#rte-tools-unused"),$error=f('<div class="notice"/>').text(EE.rte.name_required);k.add(j).sortable({connectWith:".rte-tools-connected",containment:".rte-toolset-builder",items:"li:not(.rte-tool-placeholder)",opacity:0.6,revert:0.25,tolerance:"pointer"});f("li[data-tool-id]").hover(function(){f(this).addClass("rte-tool-hover")},function(){f(this).removeClass("rte-tool-hover")}).click(function(){a=a.add(f(this).addClass("rte-tool-active"))});f("#rte-tools-select").click(function(){j.find("li.rte-tool-active").appendTo(k);e()});f("#rte-tools-deselect").click(function(){k.find("li.rte-tool-active").appendTo(j);e()});f("#rte-toolset-name").parents("form").submit(function(r){$error.remove();r.preventDefault();var q=f(this),t=f("#rte-toolset-name"),p=t.val(),n=EE.rte.validate_toolset_name_url.replace(/&amp;/g,"&"),o=q.attr("action"),s=o.replace(/.*?rte_toolset_id=(\d+)/,"$1");s=f.isNumeric(s)?"&rte_toolset_id="+s:"";f.get(n+"&name="+p+s,function(u){if(p==""||!u.valid){$error.appendTo(t.parent())}else{f.post(o+"&"+q.serialize(),function(v){i.dialog("close");window.location=window.location})}},"json")})}function e(){var n=[];k.find("li[data-tool-id]").each(function(){n.push(f(this).data("tool-id"))});f("#rte-toolset-tools").val(n.join("|"));a.removeClass("rte-tool-active");a=f("#noyourenevergonnagetit")}if(f("#rte-tools-selected").length){g()}})(jQuery);